FROM node:16-slim

WORKDIR /lib

COPY package* ./
RUN --mount=type=secret,id=npmrc,dst=/lib/.npmrc --mount=type=cache,target=~/.npm npm ci

COPY . .
RUN npm run build
